<!DOCTYPE html>
<html>
<head>
    <title>Edit Settings</title>
    <style>
        label {
            display: block;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Edit Settings</h1>
    <form id="settingsForm">
        <h2>DAC Settings</h2>
        <div id="dacSettings"></div>
        <h2>Relay Settings</h2>
        <div id="relaySettings"></div>
        <button type="submit">Save</button>
    </form>

    <script>
    function generateInputs(section, data) {
        const container = document.getElementById(section + 'Settings');
        data.forEach((item, index) => {
            const div = document.createElement('div');
            div.innerHTML = `<label>Address: ${item.id}</label>`;  // Non-editable address field

            const nameLabel = document.createElement('label');
            nameLabel.textContent = 'Name:';
            const nameInput = document.createElement('input');
            nameInput.setAttribute('type', 'text');
            nameInput.setAttribute('name', `${section}[${index}][name]`);
            nameInput.setAttribute('value', item.name || '');
            div.appendChild(nameLabel);
            div.appendChild(nameInput);

            if (section === 'dac') {
                const channelLabel = document.createElement('label');
                channelLabel.textContent = 'Channel (0 or 1):';
                const channelInput = document.createElement('input');
                channelInput.setAttribute('type', 'number');
                channelInput.setAttribute('name', `${section}[${index}][channel]`);
                channelInput.setAttribute('value', item.chan || 0);
                channelInput.setAttribute('min', '0');
                channelInput.setAttribute('max', '1');
                div.appendChild(channelLabel);
                div.appendChild(channelInput);
            }

            container.appendChild(div);
        });
    }

    fetch('/config')
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(jsonData => {
        console.log(jsonData);
        generateInputs('dac', jsonData.dac);
        generateInputs('relay', jsonData.relay);
    })
    .catch(error => {
        console.error('Fetch error:', error);
    });


        
    </script>
</body>
</html>
